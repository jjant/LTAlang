# :shipit: LTAlang

LTAlang is a programming language with great features compiling to ECMAscript 2017

## Documentation
The report can be found under the name `Informe.pdf` under this same repository.

## Build & Run
To build and run

```bash
git clone https://github.com/jjant/LTAlang.git && cd LTAlang
make all
chmod 777 ./compiler #This is necessary to execute the compiler
./compiler input.lta > out.js
```

Finally, to run the compiled code you could use both `node` environment by running

```bash
node out.js
```

or try it in the javascript console of a modern browser.

## Example program
```lta
times = |n| => { return(|arr| => {
    return(a.map(|el| => {
      return(el * n)
    }))
  })
}

a = [1,2,3,4,5]
puts(times(2)(a)) (: [2, 4, 6, 8, 10]
```

## Requirements
You must have `node > v8.2.1` and `npm > v5.3.0` installed on your system.
The compiled code can be run in both `node` and Chrome's (`>v62`) console.

The project was also tested in the `pampero.it.itba.edu.ar` environment.

## How it works
The compiler has 3 main parts:

- Lexer: Found in `src/grammar/lexer.l`, this file defines a `lex/flex` lexer, used to match and tokenise lexemes.
- Parser: The `YACC/Bison` file under `src/grammar/grammar.y` contains a grammar with attributes, which parses a LTAlang program and outputs an abstract syntax tree.
- Code generator: Found in `src/code_generator/main.c`, is the code generator, which traverses the AST generated by the parser and outputs ECMAscript code. The file `nodes.h` defines the nodes used in the AST.

## Code examples
Check the  `examples/` folder to see some of valid LTA languages organised by features.

## Project organisation
The project is divided in several folders and files:

* Folder `src`: Contains the code for the parser, lexer and code generator.
* Folder `grammar`: Contains the code for YACC and LEXX. Here we defined the grammar and tokenise the input.
* Folder `examples`: Contains a series of valid LTA program samples.
* `./compiler`: Runs the compiler after it's been built and given permissions to execute it.

## Features
These are some of the features that we included in the LTA language

* C-like operators (`||`, `&&`, `<<`, etc)
* Weak typing (but with primitive types `Number`, `String`, `Boolean`, `Array` and `Function`)
* Literals (eg: `1.232`, `-4`, `true`, `"Even strings!"`)
* Cycles with `loop`
* Conditionals with `if`
* Lamdas (anonymous functions) with `|x| => { ... }`
* Sync and Async functions with `=>` and `|>` operators
* Input/Output handling with `read` and `puts` respectively
* Native hashes (key-value pairs) with `| key: value |`
* Single line comments with `(:`
* Mathematic utils library with `Math` native hash.
* Self-reference in functions with `this`
* Newlines as endmarkers (no ugly `;`s)

## Caveats
This is a list of considerations to take into account when using or programming in LTA:

* The resulting code is valid ES2017 code. It should be tested on modern browsers, the latest versions of nodejs or by transpiling it to older ECMAscript versions.
* To achieve several functionalities we leverage on the power of Javascript. For example, our native `Math` library is just a wrapper for Javascript `Math` library. The self-reference keyword `this` is just a wrapper for javascript's `arguments.callee`. The asynchronous functions with `|>` leverages on javascript event loop, `async` functions and `setTimeout`.

## Dependencies
We used [`prompt-sync`](https://github.com/0x00A/prompt-sync) to enable stdin input from nodejs.

## Authors
* Julian Antonielli (@jant) jantonielli@itba.edu.ar
* Ramiro Olivera Fedi (@ramadis) rolivera@itba.edu.ar
