{"version":3,"sources":["../../../src/intrinsics/node/bootstrap.js"],"names":["realm","nodeSourceCode","process","binding","bootstrapSource","bootstrapFilename","bootstrapFn","$GlobalEnv","execute","$Call"],"mappings":";;;;;;kBAiBe,UAASA,KAAT,EAAsC;AACnD;AACA,MAAIC,iBAAiBC,QAAQC,OAAR,CAAgB,SAAhB,CAArB;AACA,MAAIC,kBAAkBH,eAAe,yBAAf,CAAtB;AACA,MAAII,oBAAoB,mBAAxB;AACA,MAAI,CAACD,eAAL,EAAsB;AACpB,UAAM,uBAAe,mDAAf,CAAN;AACD;;AAED;AACA,MAAIE,cAAcN,MAAMO,UAAN,CAAiBC,OAAjB,CAAyBJ,eAAzB,EAA0CC,iBAA1C,EAA6D,EAA7D,CAAlB;;AAEA,MAAI,EAAEC,2CAAF,KAA2C,CAACA,YAAYG,KAA5D,EAAmE;AACjE,UAAM,uBAAe,2DAAf,CAAN;AACD;;AAED,SAAOH,WAAP;AACD,C;;AAvBD;;AAEA","file":"bootstrap.js","sourcesContent":["/**\n * Copyright (c) 2017-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n */\n\n/* @flow */\n\nimport { FatalError } from \"../../errors.js\";\nimport type { Realm } from \"../../realm.js\";\nimport { FunctionValue } from \"../../values/index.js\";\n\ndeclare var process: any;\n\nexport default function(realm: Realm): FunctionValue {\n  // Extract the bootstrap source code from the hosting Node version.\n  let nodeSourceCode = process.binding(\"natives\");\n  let bootstrapSource = nodeSourceCode[\"internal/bootstrap_node\"];\n  let bootstrapFilename = \"bootstrap_node.js\";\n  if (!bootstrapSource) {\n    throw new FatalError(\"The node-cli mode is only compatible with Node 7.\");\n  }\n\n  // We evaluate bootstrap script to get the bootstrap function.\n  let bootstrapFn = realm.$GlobalEnv.execute(bootstrapSource, bootstrapFilename, \"\");\n\n  if (!(bootstrapFn instanceof FunctionValue) || !bootstrapFn.$Call) {\n    throw new FatalError(\"The node bootstrap script should always yield a function.\");\n  }\n\n  return bootstrapFn;\n}\n"]}